package com.sinotn.common.utils;

/*
 * Copyright 2004 Jeremias Maerki.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStream;

import org.apache.struts2.ServletActionContext;
import org.krysalis.barcode4j.impl.code128.Code128Bean;
import org.krysalis.barcode4j.impl.code39.Code39Bean;
import org.krysalis.barcode4j.output.bitmap.BitmapCanvasProvider;
import org.krysalis.barcode4j.tools.UnitConv;

/**
 * This example demonstrates creating a bitmap barcode using the bean API.
 * 
 * @author Jeremias Maerki
 * @version $Id: SampleBitmapBarcodeWithBean.java,v 1.1 2016/09/30 02:12:45 sinocvs Exp $
 */
public class SampleBitmapBarcodeWithBean {
  public static final String basePath = "//barCode";
  public static final String EXAMINEE_CODE_PATH = "/barCode/examineeId";
  public static final String LICENCE_CODE_PATH = "/barCode/licence";
  public static String createImage(String number,String path){
	 //String savePath = "D://1//";
	 //String fileDir = Config.findHomeDir()+"/"+path;
	 String savePath = ServletActionContext.getServletContext().getRealPath(path);
	 String fileDir = savePath;
	  String fileName = savePath + "/"+number+".png";
	  String webPath = path+ "/"+number+".png";
      try {
          //Create the barcode bean
    	  //Code39Bean bean = new Code39Bean();
          Code128Bean bean = new Code128Bean();
          final int dpi = 150;
          //Configure the barcode generator
          double tempModuleWidth = UnitConv.in2mm(2.0f / dpi);
         // System.out.println(tempModuleWidth);
          bean.setModuleWidth(tempModuleWidth); //makes the narrow bar 
          //bean.setWideFactor(3);
          bean.doQuietZone(true);

          File dir = new File(fileDir);
          if(!dir.exists()){
        	  dir.mkdirs();
          }
          //Open output file
          File outputFile = new File(fileName);
          OutputStream out = new FileOutputStream(outputFile);
          try {
              //Set up the canvas provider for monochrome JPEG output 
              BitmapCanvasProvider canvas = new BitmapCanvasProvider(
                      out, "image/png", dpi, BufferedImage.TYPE_BYTE_BINARY, false, 0);
          
              //Generate the barcode
              bean.generateBarcode(canvas, number);
              //Signal end of generation
              canvas.finish();
          }  catch (Exception e) {
        	  System.out.println(e.getMessage());
              e.printStackTrace();
          } finally {
              out.close();
          }
      } catch (Exception e) {
    	  System.out.println(e.getMessage());
          e.printStackTrace();
      }
	  return webPath;
  }

    public static void main(String[] args) {
    	
    	//String[] temp = {"1442060600001","1442060600002","1442060600003","1442060600004","1442060600005","1442060600006","1442060600007","1442060600008","1442060600009","1442060600010","1442060600011","1442060600012","1442060600013","1442060600014","1442060600015","1442060600016","1442060600017","1442060600018","1442060600019","1442060600020","1442060600021","1442060600022","1442060600023","1442060600024","1442060600025","1442060600026","1442060600027","1442060600028","1442060600029","1442060600030","1442060600031","1442060600032","1442060600033","1442060600034","1442060600035","1442060600036","1442060600037","1442060600038","1442060600039","1442060600040","1442060600041","1442060600042","1442060600043","1442060600044","1442060600045","1442060600046","1442060600047","1442060600048","1442060600049","1442060600050","1442060600051","1442060600052","1442060600053","1442060600054","1442060600055","1442060600056","1442060600057","1442060600058","1442060600059","1442060600060","1442060600061","1442060600062","1442060600063","1442060600064","1442060600065","1442060600066","1442060600067","1442060600068","1442060600069","1442060600070","1442060600071","1442060600072","1442060600073","1442060600074","1442060600075","1442060600076","1442060600077","1442060600078","1442060600079","1442060600080","1442060600081","1442060600082","1442060600083","1442060600084","1442060600085","1442060600086","1442060600087","1442060600088","1442060600089","1442060600090","1442060600091","1442060600092","1442060600093","1442060600094","1442060600095","1442060600096","1442060600097","1442060600098","1442060600099","1442060600100","1442060600101","1442060600102","1442060600103","1442060600104","1442060600105","1442060600106","1442060600107","1442060600108","1442060600109","1442060600110","1442060600111","1442060600112","1442060600113","1442060600114","1442060600115","1442060600116","1442060600117","1442060600118","1442060600119","1442060600120","1442060600121","1442060600122","1442060600123","1442060600124","1442060600125","1442060600126","1442060600127","1442060600128","1442060600129","1442060600130","1442060600131","1442060600132","1442060600133","1442060600134","1442060600135","1442060600136","1442060600137","1442060600138","1442060600139","1442060600140","1442060600141","1442060600142","1442060600143","1442060600144","1442060600145","1442060600146","1442060600147","1442060600148","1442060600149","1442060600150","1442060600151","1442060600152","1442060600153","1442060600154","1442060600155","1442060600156","1442060600157","1442060600158","1442060600159","1442060600160","1442060600161","1442060600162","1442060600163","1442060600164","1442060600165","1442060600166","1442060600167","1442060600168","1442060600169","1442060600170","1442060600171","1442060600172","1442060600173","1442060600174","1442060600175","1442060600176","1442060600177","1442060600178","1442060600179","1442060600180","1442060600181","1442060600182","1442060600183","1442060600184","1442060600185","1442060600186","1442060600187","1442060600188","1442060600189","1442060600190","1442060600191","1442060600192","1442060600193","1442060600194","1442060600195","1442060600196","1442060600197","1442060600198","1442060600199","1442060600200","1442060600201","1442060600202","1442060600203","1442060600204","1442060600205","1442060600206","1442060600207","1442060600208","1442060600209","1442060600210","1442060600211","1442060600212","1442060600213","1442060600214","1442060600215","1442060600216","1442060600217","1442060600218","1442060600219","1442060600220","1442060600221","1442060600222","1442060600223","1442060600224","1442060600225","1442060600226","1442060600227","1442060600228","1442060600229","1442060600230","1442060600231","1442060600232","1442060600233","1442060600234","1442060600235","1442060600236","1442060600237","1442060600238","1442060600239","1442060600240","1442060600241","1442060600242","1442060600243","1442060600244","1442060600245","1442060600246","1442060600247","1442060600248","1442060600249","1442060600250","1442060600251","1442060600252","1442060600253","1442060600254","1442060600255","1442060600256","1442060600257","1442060600258","1442060600259","1442060600260","1442060600261","1442060600262","1442060600263","1442060600264","1442060600265","1442060600266","1442060600267","1442060600268","1442060600269","1442060600270","1442060600271","1442060600272","1442060600273","1442060600274","1442060600275","1442060600276","1442060600277","1442060600278","1442060600279","1442060600280","1442060600281","1442060600282","1442060600283","1442060600284","1442060600285","1442060600286","1442060600287","1442060600288","1442060600289","1442060600290","1442060600291","1442060600292","1442060600293","1442060600294","1442060600295","1442060600296","1442060600297","1442060600298","1442060600299","1442060600300","1442060600301","1442060600302","1442060600303","1442060600304","1442060600305","1442060600306","1442060600307","1442060600308","1442060600309","1442060600310","1442060600311","1442060600312","1442060600313","1442060600314","1442060600315","1442060600316","1442060600317","1442060600318","1442060600319","1442060600320","1442060600321","1442060600322","1442060600323","1442060600324","1442060600325","1442060600326","1442060600327","1442060600328","1442060600329","1442060600330","1442060600331","1442060600332","1442060600333","1442060600334","1442060600335","1442060600336","1442060600337","1442060600338","1442060600339","1442060600340","1442060600341","1442060600342","1442060600343","1442060600344","1442060600345","1442060600346","1442060600347","1442060600348","1442060600349","1442060600350","1442060600351","1442060600352","1442060600353","1442060600354","1442060600355","1442060600356","1442060600357","1442060600358","1442060600359","1442060600360","1442060600361","1442060600362","1442060600363","1442060600364","1442060600365","1442060600366","1442060600367","1442060600368","1442060600369","1442060600370","1442060600371","1442060600372","1442060600373","1442060600374","1442060600375","1442060600376","1442060600377","1442060600378","1442060600379","1442060600380","1442060600381","1442060600382","1442060600383","1442060600384","1442060600385","1442060600386","1442060600387","1442060600388","1442060600389","1442060600390","1442060600391","1442060600392","1442060600393","1442060600394","1442060600395","1442060600396","1442060600397","1442060600398","1442060600399","1442060600400","1442060600401","1442060600402","1442060600403","1442060600404","1442060600405","1442060600406","1442060600407","1442060600408","1442060600409","1442060600410","1442060600411","1442060600412","1442060600413","1442060600414","1442060600415","1442060600416","1442060600417","1442060600418","1442060600419","1442060600420","1442060600421","1442060600422","1442060600423","1442060600424","1442060600425","1442060600426","1442060600427","1442060600428","1442060600429","1442060600430","1442060600431","1442060600432","1442060600433","1442060600434","1442060600435","1442060600436","1442060600437","1442060600438","1442060600439","1442060600440","1442060600441","1442060600442","1442060600443","1442060600444","1442060600445","1442060600446","1442060600447","1442060600448","1442060600449","1442060600450","1442060600451","1442060600452","1442060600453","1442060600454","1442060600455","1442060600456","1442060600457","1442060600458","1442060600459","1442060600460","1442060600461","1442060600462","1442060600463","1442060600464","1442060600465","1442060600466","1442060600467","1442060600468","1442060600469","1442060600470","1442060600471","1442060600472","1442060600473","1442060600474","1442060600475","1442060600476","1442060600477","1442060600478","1442060600479","1442060600480","1442060600481","1442060600482","1442060600483","1442060600484","1442060600485","1442060600486","1442060600487","1442060600488","1442060600489","1442060600490","1442060600491","1442060600492","1442060600493","1442060600494","1442060600495","1442060600496","1442060600497","1442060600498","1442060600499","1442060600500","1442060600501","1442060600502","1442060600503","1442060600504","1442060600505","1442060600506","1442060600507","1442060600508","1442060600509","1442060600510","1442060600511","1442060600512","1442060600513","1442060600514","1442060600515","1442060600516","1442060600517","1442060600518","1442060600519","1442060600520","1442060600521","1442060600522","1442060600523","1442060600524","1442060600525","1442060600526","1442060600527","1442060600528","1442060600529","1442060600530","1442060600531","1442060600532","1442060600533","1442060600534","1442060600535","1442060600536","1442060600537","1442060600538","1442060600539","1442060600540","1442060600541","1442060600542","1442060600543","1442060600544","1442060600545","1442060600546","1442060600547","1442060600548","1442060600549","1442060600550","1442060600551","1442060600552","1442060600553","1442060600554","1442060600555","1442060600556","1442060600557","1442060600558","1442060600559","1442060600560","1442060600561","1442060600562","1442060600563","1442060600564","1442060600565","1442060600566","1442060600567","1442060600568","1442060600569","1442060600570","1442060600571","1442060600572","1442060600573","1442060600574","1442060600575","1442060600576","1442060600577","1442060600578","1442060600579","1442060600580","1442060600581","1442060600582","1442060600583","1442060600584","1442060600585","1442060600586","1442060600587","1442060600588","1442060600589","1442060600590","1442060600591","1442060600592","1442060600593","1442060600594","1442060600595","1442060600596","1442060600597","1442060600598","1442060600599","1442060600600","1442060600601","1442060600602","1442060600603","1442060600604","1442060600605","1442060600606","1442060600607","1442060600608","1442060600609","1442060600610","1442060600611","1442060600612","1442060600613","1442060600614","1442060600615","1442060600616","1442060600617","1442060600618","1442060600619","1442060600620","1442060600621","1442060600622","1442060600623","1442060600624","1442060600625","1442060600626","1442060600627","1442060600628","1442060600629","1442060600630","1442060600631","1442060600632","1442060600633","1442060600634","1442060600635","1442060600636","1442060600637","1442060600638","1442060600639","1442060600640","1442060600641","1442060600642","1442060600643","1442060600644","1442060600645","1442060600646","1442060600647","1442060600648","1442060600649","1442060600650","1442060600651","1442060600652","1442060600653","1442060600654","1442060600655","1442060600656","1442060600657","1442060600658","1442060600659","1442060600660","1442060600661","1442060600662","1442060600663","1442060600664","1442060600665","1442060600666","1442060600667","1442060600668","1442060600669","1442060600670","1442060600671","1442060600672","1442060600673","1442060600674","1442060600675","1442060600676","1442060600677","1442060600678","1442060600679","1442060600680","1442060600681","1442060600682","1442060600683","1442060600684","1442060600685","1442060600686","1442060600687","1442060600688","1442060600689","1442060600690","1442060600691","1442060600692","1442060600693","1442060600694","1442060600695","1442060600696","1442060600697","1442060600698","1442060600699","1442060600700","1442060600701","1442060600702","1442060600703","1442060600704","1442060600705","1442060600706","1442060600707","1442060600708","1442060600709","1442060600710","1442060600711","1442060600712","1442060600713","1442060600714","1442060600715","1442060600716","1442060600717","1442060600718","1442060600719","1442060600720","1442060600721","1442060600722","1442060600723","1442060600724","1442060600725","1442060600726","1442060600727","1442060600728","1442060600729","1442060600730","1442060600731","1442060600732","1442060600733","1442060600734","1442060600735","1442060600736","1442060600737","1442060600738","1442060600739","1442060600740","1442060600741","1442060600742","1442060600743","1442060600744","1442060600745","1442060600746","1442060600747","1442060600748","1442060600749","1442060600750","1442060600751","1442060600752","1442060600753","1442060600754","1442060600755","1442060600756","1442060600757","1442060600758","1442060600759","1442060600760","1442060600761","1442060600762","1442060600763","1442060600764","1442060600765","1442060600766","1442060600767","1442060600768","1442060600769","1442060600770","1442060600771","1442060600772","1442060600773","1442060600774","1442060600775","1442060600776","1442060600777","1442060600778","1442060600779","1442060600780","1442060600781","1442060600782","1442060600783","1442060600784","1442060600785","1442060600786","1442060600787","1442060600788","1442060600789","1442060600790","1442060600791","1442060600792","1442060600793","1442060600794","1442060600795","1442060600796","1442060600797","1442060600798","1442060600799","1442060600800","1442060600801","1442060600802","1442060600803","1442060600804","1442060600805","1442060600806","1442060600807","1442060600808","1442060600809","1442060600810","1442060600811","1442060600812","1442060600813","1442060600814","1442060600815","1442060600816","1442060600817","1442060600818","1442060600819","1442060600820","1442060600821","1442060600822","1442060600823","1442060600824","1442060600825","1442060600826","1442060600827","1442060600828","1442060600829","1442060600830","1442060600831","1442060600832","1442060600833","1442060600834","1442060600835","1442060600836","1442060600837","1442060600838","1442060600839","1442060600840","1442060600841","1442060600842","1442060600843","1442060600844","1442060600845","1442060600846","1442060600847","1442060600848","1442060600849","1442060600850","1442060600851","1442060600852","1442060600853","1442060600854","1442060600855","1442060600856","1442060600857","1442060600858","1442060600859","1442060600860","1442060600861","1442060600862","1442060600863","1442060600864","1442060600865","1442060600866","1442060600867","1442060600868","1442060600869","1442060600870","1442060600871","1442060600872","1442060600873","1442060600874","1442060600875","1442060600876","1442060600877","1442060600878","1442060600879","1442060600880","1442060600881","1442060600882","1442060600883","1442060600884","1442060600885","1442060600886","1442060600887","1442060600888","1442060600889","1442060600890","1442060600891","1442060600892","1442060600893","1442060600894","1442060600895","1442060600896","1442060600897","1442060600898","1442060600899","1442060600900","1442060600901","1442060600902","1442060600903","1442060600904","1442060600905","1442060600906","1442060600907","1442060600908","1442060600909","1442060600910","1442060600911","1442060600912","1442060600913","1442060600914","1442060600915","1442060600916","1442060600917","1442060600918","1442060600919","1442060600920","1442060600921","1442060600922","1442060600923","1442060600924","1442060600925","1442060600926","1442060600927","1442060600928","1442060600929","1442060600930","1442060600931","1442060600932","1442060600933","1442060600934","1442060600935","1442060600936","1442060600937","1442060600938","1442060600939","1442060600940","1442060600941","1442060600942","1442060600943","1442060600944","1442060600945"};
    	
    	SampleBitmapBarcodeWithBean sbbw = new SampleBitmapBarcodeWithBean();
    	for(int i=10000001;i<10000031;i++){
    		sbbw.createImage(i+"", SampleBitmapBarcodeWithBean.basePath);
    	}
    	
    }
}
